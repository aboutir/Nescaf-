<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Page d'accueil avec statiques, carrousel et bannière image</title>

  <!-- Material Icons CDN -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

  <style>
    /* Styles précédents inchangés */
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f3f6;
      color: #3b3b3b;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .carousel {
      position: relative;
      width: 100vw;
      height: 210px;
      border-radius: 0;
      overflow: hidden;
      box-shadow: 0 6px 15px rgba(80, 227, 194, 0.3);
      user-select: none;
      margin: 0;
      left: 0;
      top: 0;
      z-index: 10;
    }
    .carousel img {
      position: absolute;
      width: 100%;
      height: 210px;
      object-fit: cover;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 1.1s ease-in-out;
    }
    .carousel img.active {
      opacity: 1;
      z-index: 1;
    }
    .container {
      max-width: 390px;
      margin: 0 auto 110px auto;
      padding: 18px;
      flex: 1 0 auto;
      box-sizing: border-box;
    }
    .carousel-buttons {
      display: flex;
      justify-content: space-between;
      margin: 12px 0;
      gap: 12px;
    }
    .btn-carousel {
      flex: 1;
      background: white;
      border: 2px solid white;
      border-radius: 24px;
      padding: 10px 6px;
      font-weight: 700;
      font-size: 0.95em;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      user-select: none;
      transition:
        background-color 0.3s ease,
        border-color 0.3s ease,
        box-shadow 0.3s ease,
        color 0.3s ease;
      box-shadow:
        0 2px 6px rgba(255 255 255 / 0.9),
        inset 0 0 6px rgba(255 255 255 / 0.7);
      position: relative;
      color: #50e3c2;
    }
    .btn-carousel:hover,
    .btn-carousel:focus {
      background-color: #50e3c2;
      color: white;
      border-color: #50e3c2;
      box-shadow:
        0 4px 14px rgba(80, 227, 194, 0.65),
        inset 0 0 15px rgba(80, 227, 194, 0.6);
      outline: none;
    }
    .btn-depot .material-icons.icon {
      color: #f5a623;
    }
    .btn-retrait .material-icons.icon {
      color: #4a90e2;
    }
    .btn-telegram .material-icons.icon {
      color: #0088cc;
    }
    .btn-carousel:hover .material-icons.icon,
    .btn-carousel:focus .material-icons.icon {
      color: white;
    }
    nav.bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 390px;
      margin: 0 auto;
      background: #fff;
      border-top: 2.5px solid #50e3c2;
      box-shadow:
        0 -3px 8px rgba(80, 227, 194, 0.37),
        inset 0 0 8px rgba(80, 227, 194, 0.24);
      display: flex;
      justify-content: space-around;
      padding: 9px 0 8px 0;
      user-select: none;
      z-index: 1000;
    }
    .nav-icon {
      flex: 1;
      color: #86929e;
      text-align: center;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.3s ease, transform 0.25s ease;
      padding: 2px 0;
      user-select: none;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .nav-icon:hover:not(.active) {
      color: #4a90e2;
      transform: scale(1.1);
    }
    .nav-icon.active {
      color: #50e3c2;
      font-weight: 700;
      transform: scale(1.15);
    }
    .nav-icon .material-icons.icon {
      font-size: 1.6em;
      margin-bottom: 4px;
      user-select: none;
    }

    /* Nouvelle section revenus stylée carrée */
    .revenus-section {
      background: linear-gradient(135deg, #50e3c2 0%, #4a90e2 100%);
      border-radius: 24px;
      padding: 24px 20px;
      box-shadow: 0 16px 30px rgba(80, 227, 194, 0.35);
      margin: 36px auto 40px auto;
      max-width: 390px;
      color: white;
      font-family: 'Nunito', Arial, sans-serif;
      user-select: none;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 18px;
      min-height: 260px;
      justify-content: center;
    }

    .section-title {
      margin: 0;
      font-weight: 800;
      font-size: 1.4rem;
      letter-spacing: 0.06em;
      text-shadow: 0 1px 6px rgba(0,0,0,0.28);
      user-select: text;
    }

    .revenus-content {
      background: rgba(255, 255, 255, 0.15);
      flex: 1;
      border-radius: 16px;
      box-shadow: inset 0 0 18px rgba(255, 255, 255, 0.4);
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 1.1rem;
      user-select: text;
      padding: 16px;
      line-height: 1.4;
    }

    /* Information lancement entreprise */
    .lancement-info {
      max-width: 390px;
      margin: 20px auto 30px auto;
      background: linear-gradient(90deg, #4a90e2, #50e3c2);
      border-radius: 20px;
      padding: 14px 20px;
      color: white;
      font-weight: 700;
      font-size: 1rem;
      text-align: center;
      box-shadow: 0 8px 20px rgba(80, 227, 194, 0.35);
      user-select: none;
      font-family: 'Nunito', Arial, sans-serif;
      letter-spacing: 0.04em;
    }

  </style>
</head>
<body>

  <!-- Carrousel pleine largeur collé en haut -->
  <div class="carousel" aria-label="Carrousel d'images promotionnelles" role="region">
    <img src="https://image.noelshack.com/fichiers/2025/32/4/1754565133-mexico-nescafe-factory-feed.jpeg" alt="Image 1" class="active" />
    <img src="https://image.noelshack.com/fichiers/2025/32/4/1754565198-2a56506d3c43c179ed42da50b814ccb3-262279842-highres-data.jpg" alt="Image 2" />
    <img src="https://image.noelshack.com/fichiers/2025/32/4/1754565251-nescaf-1160x700.jpg" alt="Image 3" />
    <img src="https://image.noelshack.com/fichiers/2025/32/4/1754565330-t-l-chargement.jpeg" alt="Image 4" />
  </div>

  <div class="container" role="main">

    <!-- Boutons actions -->
    <div class="carousel-buttons" role="group" aria-label="Actions rapides carrousel">
      <button class="btn-carousel btn-depot" data-link="recharge.html" aria-label="Dépôt">
        <span class="material-icons icon" aria-hidden="true">attach_money</span> Recharge
      </button>
      <button class="btn-carousel btn-retrait" data-link="retrait.html" aria-label="Retrait">
        <span class="material-icons icon" aria-hidden="true">swap_horiz</span> Retrait
      </button>
      <button class="btn-carousel btn-telegram" data-link="service-clien.html" aria-label="Groupe Télégramme">
        <span class="material-icons icon" aria-hidden="true">groups</span> Service client 
      </button>
    </div>

    <!-- Bloc Statistiques -->
    <div class="statistiques-boxes" style="margin-top:12px;">
      <div class="stat-box solde">
        <span class="stat-label">Solde du compte</span>
        <span class="stat-value">FCFA 0</span>
      </div>
      <div class="stat-row">
        <!-- Possibilité d'ajouter d'autres stat-box.small ici -->
      </div>
      
      <!-- Parrainage avec image de fond -->
      <div class="parrainage-banner" role="region" aria-label="Bannière parrainage">
        <strong>RÉCOMPENSES DE PARRAINAGE</strong><br />
        INVITEZ VOS AMIS POUR OBTENIR<br />
        DES RÉCOMPENSES IMPORTANTES
      </div>

      <!-- Information lancement entreprise -->
      <div class="lancement-info" role="note" aria-live="polite">
        Date de lancement de l'entreprise NESCAFÉ : <strong>04 octobre 2025</strong><br />
        Durée d'objectif : <strong>04 octobre 2026</strong>
      </div>
    </div>

    <!-- Nouvelle section Revenus et Investissements -->
    <section class="revenus-section" aria-label="Tableau des revenus et investissements">
      <h2 class="section-title">Revenus et Investissements</h2>
      <div class="revenus-content">
        <img 
          src="https://image.noelshack.com/fichiers/2025/41/4/1759963093-screenshot-20251008-223233-trebedit.jpg" 
          alt="Tableau des revenus Nescafé" 
          style="max-width: 100%; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.2);" 
        />
      </div>
    </section>

  </div>

  <nav class="bottom-nav" role="navigation" aria-label="Navigation principale">
    <div class="nav-icon active" data-link="Accueil.html" tabindex="0" role="link" aria-current="page" aria-label="Accueil">
      <span class="material-icons icon" aria-hidden="true">home</span>
      Accueil
    </div>
    <div class="nav-icon" data-link="appareils.html" tabindex="0" role="link" aria-label="Appareils">
      <span class="material-icons icon" aria-hidden="true">smartphone</span>
      Nescafé
    </div>
    <div class="nav-icon" data-link="machine.html" tabindex="0" role="link" aria-label="Mes Nescafé">
      <span class="material-icons icon" aria-hidden="true">list_alt</span>
      Mes Nescafé
    </div>
    <div class="nav-icon" data-link="solde.html" tabindex="0" role="link" aria-label="Profil">
      <span class="material-icons icon" aria-hidden="true">person</span>
      Profil
    </div>
  </nav>

  <script>
    // Carrousel automatique
    (function () {
      const images = document.querySelectorAll('.carousel img');
      let current = 0;
      function nextSlide() {
        images[current].classList.remove('active');
        current = (current + 1) % images.length;
        images[current].classList.add('active');
      }
      setInterval(nextSlide, 3000);
    })();

    // Spinner/loading button
    function showLoading(button) {
      if (button.classList.contains('loading')) return false;
      const icon = button.querySelector('.icon');
      if (icon) icon.style.display = 'none';
      let spinner = button.querySelector('.spinner');
      if (!spinner) {
        spinner = document.createElement('span');
        spinner.className = 'spinner';
        button.insertBefore(spinner, button.firstChild);
      }
      spinner.style.display = 'inline-block';
      button.classList.add('loading');
      button.disabled = true;
      return true;
    }
    function hideLoading(button) {
      const icon = button.querySelector('.icon');
      if (icon) icon.style.display = 'inline-block';
      const spinner = button.querySelector('.spinner');
      if (spinner) spinner.style.display = 'none';
      button.classList.remove('loading');
      button.disabled = false;
    }
    function handleButtonClick(event) {
      event.preventDefault();
      const btn = event.currentTarget;
      if (!showLoading(btn)) return;
      const url = btn.getAttribute('data-link');
      if (!url) {
        hideLoading(btn);
        return;
      }
      setTimeout(() => {
        window.location.href = url;
      }, 300);
    }
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.btn-carousel, nav.bottom-nav .nav-icon').forEach(btn => {
        btn.addEventListener('click', handleButtonClick);
        btn.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      });
    });
  </script>

  <!-- SCRIPT POUR AFFICHER LES SOLDES DYNAMIQUEMENT -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";

    // === Configuration et initialisation Firebase ===
    const firebaseConfig = {
      apiKey: "AIzaSyBbnOxwcCXHAHJWxPw90YGvSuPCOyp6-lA",
      authDomain: "nescafe-cba7a.firebaseapp.com",
      databaseURL: "https://nescafe-cba7a-default-rtdb.firebaseio.com",
      projectId: "nescafe-cba7a",
      storageBucket: "nescafe-cba7a.firebasestorage.app",
      messagingSenderId: "91209018725",
      appId: "1:91209018725:web:adb0d2a8b458591c8a058c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const database = getDatabase(app);

    // Formate FCFA
    function formatFCFA(amount) {
      if (amount == null || isNaN(amount)) amount = 0;
      return 'FCFA ' + Number(amount).toLocaleString('fr-FR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
    }

    onAuthStateChanged(auth, (user) => {
      const soldeCompteEl = document.querySelector('.stat-box.solde .stat-value');
      const totalRetraitEl = document.querySelectorAll('.stat-box.small')[0]?.querySelector('.stat-value');
      const gainAppareilEl = document.querySelectorAll('.stat-box.small')[1]?.querySelector('.stat-value');

      if (user) {
        const uid = user.uid;
        const userRef = ref(database, `users/${uid}`);

        // Écoute temps réel des données utilisateur
        onValue(userRef, (snapshot) => {
          const data = snapshot.val() || {};

          soldeCompteEl.textContent = formatFCFA(data.balance ?? 0);
          if (totalRetraitEl) totalRetraitEl.textContent = formatFCFA(data.totalWithdrawals ?? 0);
          if (gainAppareilEl) gainAppareilEl.textContent = formatFCFA(data.totalRevenue ?? 0);
        });
      } else {
        // Pas connecté: affichage par défaut
        soldeCompteEl.textContent = 'FCFA 0';
        if (totalRetraitEl) totalRetraitEl.textContent = 'FCFA 0';
        if (gainAppareilEl) gainAppareilEl.textContent = 'FCFA 0';
      }
    });
  </script>

</body>
</html>
